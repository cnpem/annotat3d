

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Framework Documentation components/tools_menu/vis_menu/CropMenu.tsx</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
             
                <a href="index.html">
                    <h1 class="navbar-item">framework documentation</h1>
                </a>
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                 
                    
                        <a
                            class="link user-link "
                            href="..."
                        >
                            Respository
                        </a>
                    
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
                <div class="search-wrapper">
                    <input id="search" type="text" placeholder="Search docs..." class="input">
                </div>
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Namespaces</h3><ul><li><a href="PIXI.html">PIXI</a></li><li><a href="PIXI.filters.html">filters</a></li><li><a href="PIXI.graphicsUtils.html">graphicsUtils</a></li><li><a href="PIXI.groupD8.html">groupD8</a></li><li><a href="PIXI.resources.html">resources</a></li><li><a href="PIXI.settings.html">settings</a></li><li><a href="PIXI.systems.html">systems</a></li></ul><h3>Classes</h3><ul><li><a href="About.html">About</a></li><li><a href="Canvas.html">Canvas</a></li><li><a href="CropMenuProps.html">CropMenuProps</a></li><li><a href="File.html">File</a></li><li><a href="Menu.html">Menu</a></li><li><a href="PIXI.AbstractRenderer.html">AbstractRenderer</a></li><li><a href="PIXI.AccessibilityManager.html">AccessibilityManager</a></li><li><a href="PIXI.AppLoaderPlugin.html">AppLoaderPlugin</a></li><li><a href="PIXI.Application.html">Application</a></li><li><a href="PIXI.BaseRenderTexture.html">BaseRenderTexture</a></li><li><a href="PIXI.BaseTexture.html">BaseTexture</a></li><li><a href="PIXI.BlobResource.html">BlobResource</a></li><li><a href="PIXI.Bounds.html">Bounds</a></li><li><a href="PIXI.BufferSystem.html">BufferSystem</a></li><li><a href="PIXI.CompressedTextureLoader.html">CompressedTextureLoader</a></li><li><a href="PIXI.Container.html">Container</a></li><li><a href="PIXI.DDSLoader.html">DDSLoader</a></li><li><a href="PIXI.DisplayObject.html">DisplayObject</a></li><li><a href="PIXI.Extract.html">Extract</a></li><li><a href="PIXI.FillStyle.html">FillStyle</a></li><li><a href="PIXI.Framebuffer.html">Framebuffer</a></li><li><a href="PIXI.FramebufferSystem.html">FramebufferSystem</a></li><li><a href="PIXI.GLFramebuffer.html">GLFramebuffer</a></li><li><a href="PIXI.GLProgram.html">GLProgram</a></li><li><a href="PIXI.GLTexture.html">GLTexture</a></li><li><a href="PIXI.Graphics.html">Graphics</a></li><li><a href="PIXI.GraphicsData.html">GraphicsData</a></li><li><a href="PIXI.GraphicsGeometry.html">GraphicsGeometry</a></li><li><a href="PIXI.InteractionData.html">InteractionData</a></li><li><a href="PIXI.InteractionEvent.html">InteractionEvent</a></li><li><a href="PIXI.InteractionManager.html">InteractionManager</a></li><li><a href="PIXI.KTXLoader.html">KTXLoader</a></li><li><a href="PIXI.LineStyle.html">LineStyle</a></li><li><a href="PIXI.Loader.html">Loader</a></li><li><a href="PIXI.MeshBatchUvs.html">MeshBatchUvs</a></li><li><a href="PIXI.MeshGeometry.html">MeshGeometry</a></li><li><a href="PIXI.MeshMaterial.html">MeshMaterial</a></li><li><a href="PIXI.ParticleContainer.html">ParticleContainer</a></li><li><a href="PIXI.ParticleRenderer.html">ParticleRenderer</a></li><li><a href="PIXI.Point.html">Point</a></li><li><a href="PIXI.Quad.html">Quad</a></li><li><a href="PIXI.QuadUv.html">QuadUv</a></li><li><a href="PIXI.RopeGeometry.html">RopeGeometry</a></li><li><a href="PIXI.RoundedRectangle.html">RoundedRectangle</a></li><li><a href="PIXI.Texture.html">Texture</a></li><li><a href="PIXI.TextureGCSystem.html">TextureGCSystem</a></li><li><a href="PIXI.TextureMatrix.html">TextureMatrix</a></li><li><a href="PIXI.TextureSystem.html">TextureSystem</a></li><li><a href="PIXI.TextureUvs.html">TextureUvs</a></li><li><a href="PIXI.Ticker.html">Ticker</a></li><li><a href="PIXI.TickerPlugin.html">TickerPlugin</a></li><li><a href="PIXI.TilingSpriteRenderer.html">TilingSpriteRenderer</a></li><li><a href="PIXI.UniformGroup.html">UniformGroup</a></li><li><a href="PIXI.ViewableBuffer.html">ViewableBuffer</a></li><li><a href="PIXI.filters.BlurFilterPass.html">BlurFilterPass</a></li><li><a href="PIXI.graphicsUtils.BatchPart.html">BatchPart</a></li><li><a href="PIXI.utils.CanvasRenderTarget.html">CanvasRenderTarget</a></li><li><a href="People.html">People</a></li><li><a href="SamplingComp.html">SamplingComp</a></li><li><a href="SignalBinding.html">SignalBinding</a></li><li><a href="SlicesMenu.html">SlicesMenu</a></li><li><a href="ThemeToggle.html">ThemeToggle</a></li></ul><h3>Interfaces</h3><ul><li><a href="CropAxisInterface.html">CropAxisInterface</a></li><li><a href="ErrorInterface.html">ErrorInterface</a></li><li><a href="HistogramInfoPayload.html">HistogramInfoPayload</a></li><li><a href="ImageShapeInterface.html">ImageShapeInterface</a></li><li><a href="IonRangeElement.html">IonRangeElement</a></li><li><a href="LabelInterface.html">LabelInterface</a></li><li><a href="MenuItem.html">MenuItem</a></li><li><a href="MultiplesPath.html">MultiplesPath</a></li><li><a href="OffscreenCanvas.html">OffscreenCanvas</a></li><li><a href="PIXI.IHitArea.html">IHitArea</a></li><li><a href="PIXI.utils.DecomposedDataUri.html">DecomposedDataUri</a></li><li><a href="PatchesInterface.html">PatchesInterface</a></li><li><a href="QueueToast.html">QueueToast</a></li><li><a href="SamplingInterface.html">SamplingInterface</a></li><li><a href="SelectInterface.html">SelectInterface</a></li><li><a href="SharedArrayBuffer.html">SharedArrayBuffer</a></li><li><a href="TableElement.html">TableElement</a></li><li><a href="TableInterface.html">TableInterface</a></li><li><a href="dataType.html">dataType</a></li><li><a href="multiplesPath_.html">multiplesPath</a></li><li>{LabelEditProps}</li><li>{<a href="LabelInterface.html">LabelInterface</a>}</li><li>{LoadingComponentInterface}</li></ul><h3>Events</h3><ul><li><a href="PIXI.BaseRenderTexture.html#event:dispose">dispose</a></li><li><a href="PIXI.BaseRenderTexture.html#event:error">error</a></li><li><a href="PIXI.BaseRenderTexture.html#event:loaded">loaded</a></li><li><a href="PIXI.BaseRenderTexture.html#event:update">update</a></li><li><a href="PIXI.BaseTexture.html#event:dispose">dispose</a></li><li><a href="PIXI.BaseTexture.html#event:error">error</a></li><li><a href="PIXI.BaseTexture.html#event:loaded">loaded</a></li><li><a href="PIXI.BaseTexture.html#event:update">update</a></li><li><a href="PIXI.Container.html#event:click">click</a></li><li><a href="PIXI.Container.html#event:mousedown">mousedown</a></li><li><a href="PIXI.Container.html#event:mousemove">mousemove</a></li><li><a href="PIXI.Container.html#event:mouseout">mouseout</a></li><li><a href="PIXI.Container.html#event:mouseover">mouseover</a></li><li><a href="PIXI.Container.html#event:mouseup">mouseup</a></li><li><a href="PIXI.Container.html#event:mouseupoutside">mouseupoutside</a></li><li><a href="PIXI.Container.html#event:pointercancel">pointercancel</a></li><li><a href="PIXI.Container.html#event:pointerdown">pointerdown</a></li><li><a href="PIXI.Container.html#event:pointermove">pointermove</a></li><li><a href="PIXI.Container.html#event:pointerout">pointerout</a></li><li><a href="PIXI.Container.html#event:pointerover">pointerover</a></li><li><a href="PIXI.Container.html#event:pointertap">pointertap</a></li><li><a href="PIXI.Container.html#event:pointerup">pointerup</a></li><li><a href="PIXI.Container.html#event:pointerupoutside">pointerupoutside</a></li><li><a href="PIXI.Container.html#event:rightclick">rightclick</a></li><li><a href="PIXI.Container.html#event:rightdown">rightdown</a></li><li><a href="PIXI.Container.html#event:rightup">rightup</a></li><li><a href="PIXI.Container.html#event:rightupoutside">rightupoutside</a></li><li><a href="PIXI.Container.html#event:tap">tap</a></li><li><a href="PIXI.Container.html#event:touchcancel">touchcancel</a></li><li><a href="PIXI.Container.html#event:touchend">touchend</a></li><li><a href="PIXI.Container.html#event:touchendoutside">touchendoutside</a></li><li><a href="PIXI.Container.html#event:touchmove">touchmove</a></li><li><a href="PIXI.Container.html#event:touchstart">touchstart</a></li><li><a href="PIXI.DisplayObject.html#event:click">click</a></li><li><a href="PIXI.DisplayObject.html#event:mousedown">mousedown</a></li><li><a href="PIXI.DisplayObject.html#event:mousemove">mousemove</a></li><li><a href="PIXI.DisplayObject.html#event:mouseout">mouseout</a></li><li><a href="PIXI.DisplayObject.html#event:mouseover">mouseover</a></li><li><a href="PIXI.DisplayObject.html#event:mouseup">mouseup</a></li><li><a href="PIXI.DisplayObject.html#event:mouseupoutside">mouseupoutside</a></li><li><a href="PIXI.DisplayObject.html#event:pointercancel">pointercancel</a></li><li><a href="PIXI.DisplayObject.html#event:pointerdown">pointerdown</a></li><li><a href="PIXI.DisplayObject.html#event:pointermove">pointermove</a></li><li><a href="PIXI.DisplayObject.html#event:pointerout">pointerout</a></li><li><a href="PIXI.DisplayObject.html#event:pointerover">pointerover</a></li><li><a href="PIXI.DisplayObject.html#event:pointertap">pointertap</a></li><li><a href="PIXI.DisplayObject.html#event:pointerup">pointerup</a></li><li><a href="PIXI.DisplayObject.html#event:pointerupoutside">pointerupoutside</a></li><li><a href="PIXI.DisplayObject.html#event:rightclick">rightclick</a></li><li><a href="PIXI.DisplayObject.html#event:rightdown">rightdown</a></li><li><a href="PIXI.DisplayObject.html#event:rightup">rightup</a></li><li><a href="PIXI.DisplayObject.html#event:rightupoutside">rightupoutside</a></li><li><a href="PIXI.DisplayObject.html#event:tap">tap</a></li><li><a href="PIXI.DisplayObject.html#event:touchcancel">touchcancel</a></li><li><a href="PIXI.DisplayObject.html#event:touchend">touchend</a></li><li><a href="PIXI.DisplayObject.html#event:touchendoutside">touchendoutside</a></li><li><a href="PIXI.DisplayObject.html#event:touchmove">touchmove</a></li><li><a href="PIXI.DisplayObject.html#event:touchstart">touchstart</a></li><li><a href="PIXI.Graphics.html#event:click">click</a></li><li><a href="PIXI.Graphics.html#event:mousedown">mousedown</a></li><li><a href="PIXI.Graphics.html#event:mousemove">mousemove</a></li><li><a href="PIXI.Graphics.html#event:mouseout">mouseout</a></li><li><a href="PIXI.Graphics.html#event:mouseover">mouseover</a></li><li><a href="PIXI.Graphics.html#event:mouseup">mouseup</a></li><li><a href="PIXI.Graphics.html#event:mouseupoutside">mouseupoutside</a></li><li><a href="PIXI.Graphics.html#event:pointercancel">pointercancel</a></li><li><a href="PIXI.Graphics.html#event:pointerdown">pointerdown</a></li><li><a href="PIXI.Graphics.html#event:pointermove">pointermove</a></li><li><a href="PIXI.Graphics.html#event:pointerout">pointerout</a></li><li><a href="PIXI.Graphics.html#event:pointerover">pointerover</a></li><li><a href="PIXI.Graphics.html#event:pointertap">pointertap</a></li><li><a href="PIXI.Graphics.html#event:pointerup">pointerup</a></li><li><a href="PIXI.Graphics.html#event:pointerupoutside">pointerupoutside</a></li><li><a href="PIXI.Graphics.html#event:rightclick">rightclick</a></li><li><a href="PIXI.Graphics.html#event:rightdown">rightdown</a></li><li><a href="PIXI.Graphics.html#event:rightup">rightup</a></li><li><a href="PIXI.Graphics.html#event:rightupoutside">rightupoutside</a></li><li><a href="PIXI.Graphics.html#event:tap">tap</a></li><li><a href="PIXI.Graphics.html#event:touchcancel">touchcancel</a></li><li><a href="PIXI.Graphics.html#event:touchend">touchend</a></li><li><a href="PIXI.Graphics.html#event:touchendoutside">touchendoutside</a></li><li><a href="PIXI.Graphics.html#event:touchmove">touchmove</a></li><li><a href="PIXI.Graphics.html#event:touchstart">touchstart</a></li><li><a href="PIXI.InteractionManager.html#event:click">click</a></li><li><a href="PIXI.InteractionManager.html#event:mousedown">mousedown</a></li><li><a href="PIXI.InteractionManager.html#event:mousemove">mousemove</a></li><li><a href="PIXI.InteractionManager.html#event:mouseout">mouseout</a></li><li><a href="PIXI.InteractionManager.html#event:mouseover">mouseover</a></li><li><a href="PIXI.InteractionManager.html#event:mouseup">mouseup</a></li><li><a href="PIXI.InteractionManager.html#event:mouseupoutside">mouseupoutside</a></li><li><a href="PIXI.InteractionManager.html#event:pointercancel">pointercancel</a></li><li><a href="PIXI.InteractionManager.html#event:pointerdown">pointerdown</a></li><li><a href="PIXI.InteractionManager.html#event:pointermove">pointermove</a></li><li><a href="PIXI.InteractionManager.html#event:pointerout">pointerout</a></li><li><a href="PIXI.InteractionManager.html#event:pointerover">pointerover</a></li><li><a href="PIXI.InteractionManager.html#event:pointertap">pointertap</a></li><li><a href="PIXI.InteractionManager.html#event:pointerup">pointerup</a></li><li><a href="PIXI.InteractionManager.html#event:pointerupoutside">pointerupoutside</a></li><li><a href="PIXI.InteractionManager.html#event:rightclick">rightclick</a></li><li><a href="PIXI.InteractionManager.html#event:rightdown">rightdown</a></li><li><a href="PIXI.InteractionManager.html#event:rightup">rightup</a></li><li><a href="PIXI.InteractionManager.html#event:rightupoutside">rightupoutside</a></li><li><a href="PIXI.InteractionManager.html#event:tap">tap</a></li><li><a href="PIXI.InteractionManager.html#event:touchcancel">touchcancel</a></li><li><a href="PIXI.InteractionManager.html#event:touchend">touchend</a></li><li><a href="PIXI.InteractionManager.html#event:touchendoutside">touchendoutside</a></li><li><a href="PIXI.InteractionManager.html#event:touchmove">touchmove</a></li><li><a href="PIXI.InteractionManager.html#event:touchstart">touchstart</a></li><li><a href="PIXI.ParticleContainer.html#event:click">click</a></li><li><a href="PIXI.ParticleContainer.html#event:mousedown">mousedown</a></li><li><a href="PIXI.ParticleContainer.html#event:mousemove">mousemove</a></li><li><a href="PIXI.ParticleContainer.html#event:mouseout">mouseout</a></li><li><a href="PIXI.ParticleContainer.html#event:mouseover">mouseover</a></li><li><a href="PIXI.ParticleContainer.html#event:mouseup">mouseup</a></li><li><a href="PIXI.ParticleContainer.html#event:mouseupoutside">mouseupoutside</a></li><li><a href="PIXI.ParticleContainer.html#event:pointercancel">pointercancel</a></li><li><a href="PIXI.ParticleContainer.html#event:pointerdown">pointerdown</a></li><li><a href="PIXI.ParticleContainer.html#event:pointermove">pointermove</a></li><li><a href="PIXI.ParticleContainer.html#event:pointerout">pointerout</a></li><li><a href="PIXI.ParticleContainer.html#event:pointerover">pointerover</a></li><li><a href="PIXI.ParticleContainer.html#event:pointertap">pointertap</a></li><li><a href="PIXI.ParticleContainer.html#event:pointerup">pointerup</a></li><li><a href="PIXI.ParticleContainer.html#event:pointerupoutside">pointerupoutside</a></li><li><a href="PIXI.ParticleContainer.html#event:rightclick">rightclick</a></li><li><a href="PIXI.ParticleContainer.html#event:rightdown">rightdown</a></li><li><a href="PIXI.ParticleContainer.html#event:rightup">rightup</a></li><li><a href="PIXI.ParticleContainer.html#event:rightupoutside">rightupoutside</a></li><li><a href="PIXI.ParticleContainer.html#event:tap">tap</a></li><li><a href="PIXI.ParticleContainer.html#event:touchcancel">touchcancel</a></li><li><a href="PIXI.ParticleContainer.html#event:touchend">touchend</a></li><li><a href="PIXI.ParticleContainer.html#event:touchendoutside">touchendoutside</a></li><li><a href="PIXI.ParticleContainer.html#event:touchmove">touchmove</a></li><li><a href="PIXI.ParticleContainer.html#event:touchstart">touchstart</a></li><li><a href="PIXI.html#.Renderer#event:context">context</a></li><li><a href="PIXI.html#.Renderer#event:postrender">postrender</a></li><li><a href="PIXI.html#.Renderer#event:prerender">prerender</a></li><li><a href="PIXI.html#.Renderer#event:resize">resize</a></li><li><a href="global.html#event:added">added</a></li><li><a href="global.html#event:destroyed">destroyed</a></li><li><a href="global.html#event:removed">removed</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AddNewFile">AddNewFile</a></li><li><a href="global.html#App">App</a></li><li><a href="global.html#AugmentationComp">AugmentationComp</a></li><li><a href="global.html#BatchInferenceComp">BatchInferenceComp</a></li><li><a href="global.html#Colormap">Colormap</a></li><li><a href="global.html#CreateDatasetH5">CreateDatasetH5</a></li><li><a href="global.html#DatasetComp">DatasetComp</a></li><li><a href="global.html#DeepLearning">DeepLearning</a></li><li><a href="global.html#DeepLoadingComp">DeepLoadingComp</a></li><li><a href="global.html#DeleteAllWindow">DeleteAllWindow</a></li><li><a href="global.html#EditLabelMenu">EditLabelMenu</a></li><li><a href="global.html#ErrorWindowComp">ErrorWindowComp</a></li><li><a href="global.html#FileLoadDialog">FileLoadDialog</a></li><li><a href="global.html#FileNameComp">FileNameComp</a></li><li><a href="global.html#FileSaveDialog">FileSaveDialog</a></li><li><a href="global.html#InferenceComp">InferenceComp</a></li><li><a href="global.html#InitAugmentationOptions">InitAugmentationOptions</a></li><li><a href="global.html#InputFileComp">InputFileComp</a></li><li><a href="global.html#InputLabel">InputLabel</a></li><li><a href="global.html#MenuContentRange">MenuContentRange</a></li><li><a href="global.html#OptionsIcons">OptionsIcons</a></li><li><a href="global.html#Page">Page</a></li><li><a href="global.html#Remote">Remote</a></li><li><a href="global.html#Settings">Settings</a></li><li><a href="global.html#SideMenuAnnot">SideMenuAnnot</a></li><li><a href="global.html#WarningWindow">WarningWindow</a></li><li><a href="global.html#WorkspaceComp">WorkspaceComp</a></li><li><a href="global.html#dispatch">dispatch</a></li><li><a href="global.html#dtypeList">dtypeList</a></li><li><a href="global.html#encodeBinary">encodeBinary</a></li><li><a href="global.html#extract">extract</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#initialOutput">initialOutput</a></li><li><a href="global.html#initialPatches">initialPatches</a></li><li><a href="global.html#punycode">punycode</a></li><li><a href="global.html#set">set</a></li><li><a href="global.html#sfetch">sfetch</a></li><li><a href="global.html#subscribe">subscribe</a></li><li><a href="global.html#typePM">typePM</a></li><li><a href="global.html#unsubscribe">unsubscribe</a></li><li><a href="global.html#useEventBus">useEventBus</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>components/tools_menu/vis_menu/CropMenu.tsx</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { IonButton, IonCard, IonCardContent, IonItem, IonLabel, IonRange, IonRow, IonToggle, useIonToast } from '@ionic/react';
import { isEqual } from 'lodash';
import { Fragment, useEffect, useRef } from 'react';
import { useStorageState } from 'react-storage-hooks';
//ignoring types for react-color, as it seems broken
//TODO: investigate if this is fixed, otherwise declare the types manually
// same problem in SideMenuVis.tsx
// @ts-ignore
import { SliderPicker } from 'react-color';

import { dispatch } from '../../../utils/eventbus';
import { sfetch } from '../../../utils/simplerequest';
import {ImageInfoInterface} from '../../main_menu/file/utils/ImageInfoInterface';
import { CropAxisInterface, CropShapeInterface } from '../utils/CropInterface';
import { ImageShapeInterface } from '../utils/ImageShapeInterface';

interface CropMenuProps {
    imageShape: ImageShapeInterface;
    disabled: boolean
}

function rgbToHex(r: number, g: number, b: number) {
    const bin = (r &lt;&lt; 16) | (g &lt;&lt; 8) | b;
    console.log('on CropMenu: rebToHex color = ', bin);
    return bin;
} 


/**
 * Enables the user to select the limits of a region of interest in the image trough three sliders (one for each axis).
 * 
 * Actions:
 * - toggleCropMode:
 *      Allows the user to preview the selected region with a highlight mask over the rejected portions of the image 
 * which are updated when the limits on the sliders for each axis are changed.
 * - Apply:
 *      Replaces the original image with the cropped image and saves its position on the original image.
 * - Merge:
 *      Opens again the original image and update the positions of labels and annotations in relation to their positions on the original image. 
 * With the 
 * 
 * @param props CropMenuProps 
 * @interface CropMenuProps { imageShape: ImageShapeInterface; disabled: boolean }
 * @constructor
 */
const CropMenu: React.FC&lt;CropMenuProps> = (props: CropMenuProps) => {

    const [toggleCropMode, setToggleCropMode] = useStorageState&lt;boolean>(sessionStorage, 'toggleCropMode', false);
    
    const [cropSliderX, setCropSliderX] = useStorageState&lt;CropAxisInterface>(sessionStorage, 'cropSliderX', {
        lower: 0,
        upper: 0
    });

    const [cropSliderY, setCropSliderY] = useStorageState&lt;CropAxisInterface>(sessionStorage, 'cropSliderY', {
        lower: 0,
        upper: 0
    });

    const [cropSliderZ, setCropSliderZ] = useStorageState&lt;CropAxisInterface>(sessionStorage, 'cropSliderZ', {
        lower: 0,
        upper: 0
    });

    const [cropPreviewColor, setCropPreviewColor] = useStorageState&lt;number>(sessionStorage, 'cropPreviewColor', 0xBF4040);

    const [showToast] = useIonToast();
    const toastTime = 2000;

    // positional range references for sliders
    const rangeRefX = useRef&lt;HTMLIonRangeElement | null>(null);
    const rangeRefY = useRef&lt;HTMLIonRangeElement | null>(null);
    const rangeRefZ = useRef&lt;HTMLIonRangeElement | null>(null);

    // updating positional range references with the new values from the sliders
    useEffect(() => {
        if (rangeRefX) {
            if (!isEqual(rangeRefX.current!.value, cropSliderX)) {
                setTimeout(() => {
                    rangeRefX.current!.value = cropSliderX;
                }, 20);
            }
        }
        if (rangeRefY) {
            if (!isEqual(rangeRefY.current!.value, cropSliderY)) {
                setTimeout(() => {
                    rangeRefY.current!.value = cropSliderY;
                }, 20);
            }
        }
        if (rangeRefZ) {
            if (!isEqual(rangeRefZ.current!.value, cropSliderZ)) {
                setTimeout(() => {
                    rangeRefZ.current!.value = cropSliderZ;
                }, 20);
            }
        }
    });

    const handleSliderChangeX = (e: CustomEvent) => {
        const newCropLims = e.detail.value as any;
        setCropSliderX(newCropLims);
        // preview
        const yLength : number = props.imageShape.y;
        const cropShape:CropShapeInterface = {
            cropX: newCropLims,
            cropY: {
                lower: yLength - cropSliderY.upper,
                upper: yLength - cropSliderY.lower
            },
            cropZ: cropSliderZ
        }
        console.log('CropMenu: onPreview', cropShape);
        // send shape to event listener (canvas)
        dispatch('cropShape', cropShape); 
        // send change to outside event listeners 
        dispatch('cropPreviewMode', true); 
        // setToggleCropMode(true);
        showToast('On Crop Preview Mode! Click Reset to deactivate.', toastTime);
    }

    const handleSliderChangeY = (e: CustomEvent) => {
        const newCropLims = e.detail.value as any;
        setCropSliderY(newCropLims);
        // preview
        const yLength : number = props.imageShape.y;
        const cropShape:CropShapeInterface = {
            cropX: cropSliderX,
            cropY: {
                lower: yLength - newCropLims.upper,
                upper: yLength - newCropLims.lower
            },
            cropZ: cropSliderZ
        }
        console.log('CropMenu: onPreview', cropShape);
        // send shape to event listener (canvas)
        dispatch('cropShape', cropShape); 
        // send change to outside event listeners 
        dispatch('cropPreviewMode', true); 
        // setToggleCropMode(true);
        showToast('On Crop Preview Mode! Click Reset to deactivate.', toastTime);
    }

    const handleSliderChangeZ = (e: CustomEvent) => {
        const newCropLims = e.detail.value as any;
        setCropSliderZ(newCropLims);
        // preview
        const yLength : number = props.imageShape.y;
        const cropShape:CropShapeInterface = {
            cropX: cropSliderX,
            cropY: {
                lower: yLength - cropSliderY.upper,
                upper: yLength - cropSliderY.lower
            },
            cropZ: newCropLims
        }
        console.log('CropMenu: onPreview', cropShape);
        // send shape to event listener (canvas)
        dispatch('cropShape', cropShape); 
        // send change to outside event listeners 
        dispatch('cropPreviewMode', true); 
        // setToggleCropMode(true);
        showToast('On Crop Preview Mode! Click Reset to deactivate.', toastTime);
    }

    /**
     * Calls a function on the backend that replaces the working image 
     * with a smaller image based on the indexes given by cropShape
     */
    function onApply() {
        setToggleCropMode(false);
        const yLength : number = props.imageShape.y;
        const cropShape:CropShapeInterface = {
            cropX: cropSliderX,
            cropY: {
                lower: yLength - cropSliderY.upper,
                upper: yLength - cropSliderY.lower
            },
            cropZ: cropSliderZ
        }
        console.log('CropMenu: onApply', cropShape);
        sfetch("POST", "/crop_apply", JSON.stringify(cropShape), "json")
        .then((img_info:ImageInfoInterface) => {
            console.log('CropMenu: onApply Success! ', img_info);
            // loads crop image
            dispatch('ImageLoaded', img_info); 
            // informs canvas that the superpixel image was deleted
            dispatch('superpixelChanged', {});
            // informs aboud annotation updates in the backend
            dispatch('annotationChanged', null);
            // deactivates crop preview mode on canvas
            dispatch('cropPreviewMode', false); 
            const msg : string = 'Crop Applied cropShape: '+cropShape+' new imageShape:'+ img_info.imageShape;
            showToast(msg, toastTime);

        })
    };
    /**
     * Calls a function on the backend that replaces the working cropped 
     * image with the original image opening it again and placing the labels 
     * and annotations on their new positions relative to the original image.
     */
    function onMerge() {
        setToggleCropMode(false);
        sfetch("POST", "/crop_merge", '', "json")
        .then((img_info:ImageInfoInterface) => {
            console.log('CropMenu: onMerge Success! ', img_info);
            // informs canvas that the original (bigger) image was loaded
            dispatch('ImageLoaded', img_info); 
            // informs canvas that the superpixel image was deleted
            dispatch('superpixelChanged', {});
            // updates label image updated in the backend
            dispatch('labelChanged','');
            // informs aboud annotation_menu updates in the backend
            dispatch('annotationChanged', null);
            // deactivates crop preview mode on canvas
            dispatch('cropPreviewMode', false); 
            showToast('Crop Merged', toastTime);
        })    
    };
    
    return (
        &lt;Fragment>
            &lt;IonCard disabled={props.disabled}>
                {/* &lt;IonCardHeader>
                    &lt;div style={ { fontWeight: 600, fontSize: 18 } }>
                        { "card name here" }
                    &lt;/div>
                &lt;/IonCardHeader> */}
                &lt;IonCardContent>
                    &lt;IonItem>
                        &lt;IonLabel>Crop Image&lt;/IonLabel>
                        &lt;IonToggle checked={toggleCropMode}
                            onIonChange={(e) => {
                                // sets toggle variable
                                console.log('handleToggleCropMode: ',e.detail.checked);
                                setToggleCropMode(e.detail.checked);
                                // Activate functions on CanvasContainer.Canvas that creates a mask layer 
                                // over the image for the current slice and every update when the 
                                // cropPreviewMode event is true.
                                dispatch('cropPreviewMode', e.detail.checked); 
                            }}>    
                        &lt;/IonToggle>
                    &lt;/IonItem>
                    &lt;div hidden={!toggleCropMode}>
                        &lt;SliderPicker color={'#'+cropPreviewColor.toString(16)}
                                onChange={ (e: any) => {
                                    const color = rgbToHex(e.rgb.r, e.rgb.g, e.rgb.b);
                                    dispatch('cropPreviewColorchanged', color);
                                    setCropPreviewColor(color);
                                } }/>
                    &lt;IonItem>
                        &lt;IonRange disabled={!toggleCropMode} name={'cropRangeX'} ref={rangeRefX} dualKnobs={true} min={0} max={props.imageShape.x} step={1} snaps={true} pin={true} ticks={false}
                            onIonKnobMoveEnd={handleSliderChangeX}>                        
                            &lt;IonLabel slot="start">&lt;h2>X&lt;/h2>&lt;/IonLabel>
                        &lt;/IonRange>
                    &lt;/IonItem>
                    &lt;IonItem>
                        &lt;IonRange disabled={!toggleCropMode} name={'cropRangeY'} ref={rangeRefY} dualKnobs={true} min={0} max={props.imageShape.y} step={1} snaps={true} pin={true} ticks={false}
                            onIonKnobMoveEnd={handleSliderChangeY}>
                            &lt;IonLabel slot="start">&lt;h2>Y&lt;/h2>&lt;/IonLabel>
                        &lt;/IonRange>
                    &lt;/IonItem>
                    &lt;IonItem>
                        &lt;IonRange disabled={!toggleCropMode} name={'cropRangeZ'} ref={rangeRefZ} dualKnobs={true} min={0} max={props.imageShape.z} step={1} snaps={true} pin={true} ticks={false}
                            onIonKnobMoveEnd={handleSliderChangeZ}>
                            &lt;IonLabel slot="start">&lt;h2>Z&lt;/h2>&lt;/IonLabel>
                        &lt;/IonRange>
                    &lt;/IonItem>                
                    &lt;IonItem>
                        &lt;IonLabel className='ion-text-wrap'>
                            Selected Range:
                            &lt;p>
                                ({cropSliderX.lower}:{cropSliderX.upper}, {cropSliderY.lower}:{cropSliderY.upper}, {cropSliderZ.lower}:{cropSliderZ.upper})
                            &lt;/p>
                        &lt;/IonLabel>
                    &lt;/IonItem>
                    &lt;IonRow class="ion-justify-content-center">
                        &lt;IonButton disabled={!toggleCropMode} color="primary"
                            size="small"
                            onClick={onApply}>
                            Apply
                        &lt;/IonButton>
                        &lt;IonButton disabled={!toggleCropMode} color="primary"
                            size="small"
                            onClick={onMerge}>
                            Merge
                        &lt;/IonButton>
                    &lt;/IonRow>
                    &lt;/div>
                    
                &lt;/IonCardContent>
                
            &lt;/IonCard>
            
        &lt;/Fragment>
    );
}

export default CropMenu;</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

<script src="scripts/search.js"> </script>


</body>
</html>
