Bootstrap: docker-daemon
From: gitregistry.cnpem.br/gcd/data-science/segmentation/ssc-annotat3d:cuda-11.2

%post
    ls /opt/Annotat3D/
    mkdir -p ~/.pip
    printf "[global]\nindex-url = $GCC_PYPI_SERVER\ntrusted-host = $GCC_PYPI_HOST\nextra-index-url = https://pypi.python.org/simple" > ~/.pip/pip.conf
    cat ~/.pip/pip.conf
    python3 -m pip install -r /opt/Annotat3D/requirements.txt
    python3 -m pip install -r /opt/Annotat3D/requirements-dev.txt

    wget "https://code.visualstudio.com/sha/download?build=stable&os=linux-deb-x64" -O code_stable_amd64.deb
    apt-get -y install ./code_stable_amd64.deb
    rm code_stable_amd64.deb

    apt-get clean

%environment
    export LC_ALL=C

%runscript
    /bin/bash
